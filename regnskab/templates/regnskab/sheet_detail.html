{% extends "regnskab/base.html" %}
{% load staticfiles %}
{% block head %}
<link rel="stylesheet" type="text/css"
href="{% static 'regnskab/sheet_detail.css' %}" />
{% endblock %}
{% block title %}Krydslisten {{ sheet }}{% endblock %}
{% block content %}
{% if sheet.legacy_style %}
<h2>Opgørelsen {{ sheet.end_date }}</h2>
<p>Denne opgørelse er fra det gamle INKA-program (før 2017) og viser hvad folk
har krydset på alle krydslisterne siden sidst regningen blev gjort op.</p>
{% else %}
<h2>Krydslisten {{ sheet }}</h2>
{% endif %}

{% if sheet_images or sheet.image_file %}
<p>Hent original:
{% if sheet.image_file %}<a href="{{ sheet.image_file.url }}">PDF</a>{% endif %}
{% for im in sheet_images %}
<a href="{% url 'regnskab:sheet_image_file_projected' pk=sheet.id page=im.page %}">{{ im.page }}</a>
{% endfor %}
</p>
{% endif %}

<div class="sheet">
<div class="sheetrow sheetrow-header">
 <div class="name"></div>
 {% for kind in sheet.columns %}
 <div class="column column-{{ kind.name }}">{{ kind.short_name }}</div>
 {% endfor %}
</div>
{% for row in sheet.rows %}
<div class="sheetrow {% if row.profile.id == highlight_profile %}highlight{% endif %}">
 <div class="name">
  {% if not sheet.legacy_style %}<div class="name-entry">{{ row.name|default:"" }}</div>{% endif %}
  <div class="chosen-person">{{ row.title_name|default:"" }}</div>
 </div>
 {% for kind in row.kinds %}
  <div class="column column-{{ kind.kind.name }}">
  <div class="crosses">
   {% for _ in kind.counter %}<div class="cross">&times;</div>{% endfor %}
  </div>
  {% if kind.count %}<div class="count">{{ kind.count|floatformat }}</div>{% endif %}
  </div>
 {% endfor %}
</div>
{% with row.image as img %}
{% if img %}
<div style="overflow: hidden; position: relative;
width: {{ img.width }}px; height: {{ img.height }}px">
<img src="{{ img.url }}" style="position: absolute;
top: -{{ img.start }}px; left: 0" />
</div>
{% endif %}
{% endwith %}
{% endfor %}
</div>
{% endblock %}
